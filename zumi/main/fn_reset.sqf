
/*

  Kurzbeschrieb:
  Database Reset

*/

/*
Fahrzeuge=[[1,1,"p","LIB_US_Willys_MB","Zumi",[1944,7,6,8,29]],[2,1,"p","LIB_US_Willys_MB","Zumi",[1944,7,9,12,22]],[3,1,"p","LIB_US_Willys_MB","Zumi",[1944,7,14,15,41]],[4,1,"p","LIB_US_Willys_MB","Zumi",[1944,7,14,15,41]],[5,1,"p","LIB_US_Willys_MB","Zumi",[1944,7,14,15,41]],[6,1,"p","LIB_US_Willys_MB","Zumi",[1944,7,14,15,41]],[7,1,"p","LIB_US_Willys_MB","Zumi",[1944,7,14,15,41]],[8,1,"p","LIB_US_Willys_MB","Zumi",[1944,7,14,15,41]],[9,1,"p","LIB_US_Willys_MB_Hood","Zumi",[1944,7,14,15,41]],[10,1,"p","LIB_US_Willys_MB_Hood","Zumi",[1944,7,14,15,41]],[11,1,"p","LIB_US_Willys_MB_Hood","Zumi",[1944,7,14,15,41]],[12,1,"p","LIB_US_Willys_MB_Hood","Zumi",[1944,7,14,15,41]],[13,1,"p","LIB_US_Willys_MB_Hood","Zumi",[1944,7,14,15,41]],[14,1,"p","LIB_US_Willys_MB_Hood","Zumi",[1944,7,14,15,41]],[15,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[16,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[17,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[18,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[19,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[20,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[21,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[22,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[23,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[24,1,"p","LIB_US_Willys_MB_M1919","Zumi",[1944,7,14,15,41]],[25,1,"p","LIB_US_Willys_MB_Ambulance","Zumi",[1944,7,14,15,41]],[26,1,"p","LIB_US_Willys_MB_Ambulance","Zumi",[1944,7,14,15,41]],[27,1,"p","LIB_US_Willys_MB_Ambulance","Zumi",[1944,7,14,15,41]],[28,1,"p","LIB_US_GMC_Parm","Zumi",[1944,7,14,15,41]],[29,1,"p","LIB_US_GMC_Parm","Zumi",[1944,7,14,15,41]],[30,1,"p","LIB_US_GMC_Parm","Zumi",[1944,7,14,15,41]],[31,1,"p","LIB_US_GMC_Fuel","Zumi",[1944,7,14,15,41]],[32,1,"p","LIB_US_GMC_Fuel","Zumi",[1944,7,14,15,41]],[33,1,"p","LIB_US_GMC_Fuel","Zumi",[1944,7,14,15,41]],[34,1,"p","LIB_US_GMC_Ammo","Zumi",[1944,7,14,15,41]],[35,1,"p","LIB_US_GMC_Ammo","Zumi",[1944,7,14,15,41]],[36,1,"p","LIB_US_GMC_Ammo","Zumi",[1944,7,14,15,41]],[37,1,"p","LIB_US_GMC_Ambulance","Zumi",[1944,7,14,15,41]],[38,1,"p","LIB_US_GMC_Ambulance","Zumi",[1944,7,14,15,41]],[39,1,"p","LIB_US_GMC_Ambulance","Zumi",[1944,7,14,15,41]],[40,1,[378.162,4630.13,-0.00662231],"LIB_US_GMC_Tent","Zumi",[1944,7,9,8,59]],[41,1,"p","LIB_US_GMC_Tent","Zumi",[1944,7,9,15,45]],[42,1,"p","LIB_US_GMC_Tent","Zumi",[1944,7,14,15,41]],[43,1,"p","LIB_US_GMC_Tent","Zumi",[1944,7,14,15,41]],[44,1,"p","LIB_US_GMC_Tent","Zumi",[1944,7,14,15,41]],[45,1,"p","LIB_US_GMC_Tent","Zumi",[1944,7,14,15,41]],[46,1,"p","LIB_US_GMC_Tent","Zumi",[1944,7,14,15,41]],[47,1,"p","LIB_US_GMC_Tent","Zumi",[1944,7,14,15,41]],[48,1,"p","LIB_US_Scout_M3","Zumi",[1944,7,14,15,41]],[49,1,"p","LIB_US_Scout_M3","Zumi",[1944,7,14,15,41]],[50,1,"p","LIB_US_Scout_M3","Zumi",[1944,7,14,15,41]],[51,1,"p","LIB_US_Scout_M3","Zumi",[1944,7,14,15,41]],[52,1,"p","LIB_US_Scout_M3","Zumi",[1944,7,14,15,42]],[53,1,"p","LIB_US_Scout_M3","Zumi",[1944,7,14,15,42]],[54,1,"p","LIB_US_Scout_M3","Zumi",[1944,7,14,15,42]],[55,1,"p","LIB_US_Scout_M3","Zumi",[1944,7,14,15,42]],[56,1,"p","LIB_US_M3_Halftrack","Zumi",[1944,7,14,16,28]],[57,1,"p","LIB_US_M3_Halftrack","Zumi",[1944,7,14,15,42]],[58,1,"p","LIB_US_M3_Halftrack","Zumi",[1944,7,14,15,42]],[59,1,"p","LIB_US_M3_Halftrack","Zumi",[1944,7,14,15,42]],[60,1,"p","LIB_US_M3_Halftrack","Zumi",[1944,7,14,15,42]],[61,1,"p","LIB_US_M3_Halftrack","Zumi",[1944,7,14,15,42]],[62,1,"p","LIB_US_M3_Halftrack","Zumi",[1944,7,14,15,42]],[63,1,"p","LIB_US_M3_Halftrack","Zumi",[1944,7,14,15,42]],[64,1,"p","LIB_M8_Greyhound","Zumi",[1944,7,14,15,42]],[65,1,"p","LIB_M8_Greyhound","Zumi",[1944,7,14,15,42]],[66,1,"p","LIB_M3A3_Stuart","Zumi",[1944,7,14,15,42]],[67,1,"p","LIB_M3A3_Stuart","Zumi",[1944,7,14,15,42]],[68,1,"p","LIB_M3A3_Stuart","Zumi",[1944,7,14,15,42]],[69,1,"p","LIB_M3A3_Stuart","Zumi",[1944,7,14,15,42]],[70,1,"p","LIB_M4A3_75","Zumi",[1944,7,14,15,42]],[71,1,"p","LIB_M4A3_75","Zumi",[1944,7,14,15,42]],[72,1,"p","LIB_M4A3_75","Zumi",[1944,7,14,15,42]],[73,1,"p","LIB_M4A3_75","Zumi",[1944,7,14,15,42]],[74,1,"p","LIB_M4A3_76","Zumi",[1944,7,14,15,42]],[75,1,"p","LIB_M4A3_76","Zumi",[1944,7,14,15,42]],[76,1,"p","LIB_M4A3_76","Zumi",[1944,7,14,15,42]],[77,1,"p","LIB_M4A3_76","Zumi",[1944,7,14,15,42]],[78,1,"p","LIB_M4A3_76_HVSS","Zumi",[1944,7,14,15,42]],[79,1,"p","LIB_M4A3_76_HVSS","Zumi",[1944,7,14,15,42]],[80,1,"p","LIB_M4A3_76_HVSS","Zumi",[1944,7,14,15,42]],[81,1,"p","LIB_M4A3_76_HVSS","Zumi",[1944,7,14,15,42]],[82,1,"p","LIB_US_P39_2","Zumi",[1944,7,14,15,42]],[83,1,"p","LIB_US_P39_2","Zumi",[1944,7,14,15,42]],[84,1,"p","LIB_US_P39_2","Zumi",[1944,7,14,15,42]],[85,1,"p","LIB_US_P39_2","Zumi",[1944,7,14,15,42]],[86,1,"p","LIB_P47","Zumi",[1944,7,14,15,42]],[87,1,"p","LIB_P47","Zumi",[1944,7,14,15,42]],[88,1,"p","LIB_C47_Skytrain","Zumi",[1944,7,14,15,42]],[89,1,"p","LIB_C47_Skytrain","Zumi",[1944,7,14,15,42]],[90,1,"p","LIB_C47_Skytrain","Zumi",[1944,7,14,18,1]]];
*/

if !isServer exitWith {};

missionended = true;

params [["_win", false]];

_inidbi = ["new", "us"] call OO_INIDBI;

//RESET
["deleteSection", "Spielerliste"] call _inidbi;
["deleteSection", "Lager"] call _inidbi;
["deleteSection", "Missionspersistenz"] call _inidbi;

Fahrzeuge = [];

//Reset Fuhrpark
fahrzeuge_temp = [[1,1,"p","LIB_US_Willys_MB",objNull,"Zumi",[1944,7,6,10,53]],[2,1,"p","LIB_US_Willys_MB",objNull,"Zumi",[1944,7,14,15,41]],[3,1,"p","LIB_US_Willys_MB",objNull,"Zumi",[1944,7,14,15,41]],[4,1,"p","LIB_US_Willys_MB",objNull,"Zumi",[1944,7,14,15,41]],[5,1,"p","LIB_US_Willys_MB",objNull,"Zumi",[1944,7,14,15,41]],[6,1,"p","LIB_US_Willys_MB",objNull,"Zumi",[1944,7,14,15,41]],[7,1,"p","LIB_US_Willys_MB",objNull,"Zumi",[1944,7,14,15,41]],[8,1,"p","LIB_US_Willys_MB",objNull,"Zumi",[1944,7,14,15,41]],[9,1,"p","LIB_US_Willys_MB_Hood",objNull,"Zumi",[1944,7,14,15,41]],[10,1,"p","LIB_US_Willys_MB_Hood",objNull,"Zumi",[1944,7,14,15,41]],[11,1,"p","LIB_US_Willys_MB_Hood",objNull,"Zumi",[1944,7,14,15,41]],[12,1,"p","LIB_US_Willys_MB_Hood",objNull,"Zumi",[1944,7,14,15,41]],[13,1,"p","LIB_US_Willys_MB_Hood",objNull,"Zumi",[1944,7,14,15,41]],[14,1,"p","LIB_US_Willys_MB_Hood",objNull,"Zumi",[1944,7,14,15,41]],[15,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[16,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[17,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[18,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[19,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[20,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[21,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[22,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[23,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[24,1,"p","LIB_US_Willys_MB_M1919",objNull,"Zumi",[1944,7,14,15,41]],[25,1,"p","LIB_US_Willys_MB_Ambulance",objNull,"Zumi",[1944,7,14,15,41]],[26,1,"p","LIB_US_Willys_MB_Ambulance",objNull,"Zumi",[1944,7,14,15,41]],[27,1,"p","LIB_US_Willys_MB_Ambulance",objNull,"Zumi",[1944,7,14,15,41]],[28,1,"p","LIB_US_GMC_Parm",objNull,"Zumi",[1944,7,14,15,41]],[29,1,"p","LIB_US_GMC_Parm",objNull,"Zumi",[1944,7,14,15,41]],[30,1,"p","LIB_US_GMC_Parm",objNull,"Zumi",[1944,7,14,15,41]],[31,1,"p","LIB_US_GMC_Fuel",objNull,"Zumi",[1944,7,14,15,41]],[32,1,"p","LIB_US_GMC_Fuel",objNull,"Zumi",[1944,7,14,15,41]],[33,1,"p","LIB_US_GMC_Fuel",objNull,"Zumi",[1944,7,14,15,41]],[34,1,"p","LIB_US_GMC_Ammo",objNull,"Zumi",[1944,7,14,15,41]],[35,1,"p","LIB_US_GMC_Ammo",objNull,"Zumi",[1944,7,14,15,41]],[36,1,"p","LIB_US_GMC_Ammo",objNull,"Zumi",[1944,7,14,15,41]],[37,1,"p","LIB_US_GMC_Ambulance",objNull,"Zumi",[1944,7,14,15,41]],[38,1,"p","LIB_US_GMC_Ambulance",objNull,"Zumi",[1944,7,14,15,41]],[39,1,"p","LIB_US_GMC_Ambulance",objNull,"Zumi",[1944,7,14,15,41]],[40,1,"p","LIB_US_GMC_Tent",objNull,"Zumi",[1944,7,14,15,41]],[41,1,"p","LIB_US_GMC_Tent",objNull,"Zumi",[1944,7,14,15,41]],[42,1,"p","LIB_US_GMC_Tent",objNull,"Zumi",[1944,7,14,15,41]],[43,1,"p","LIB_US_GMC_Tent",objNull,"Zumi",[1944,7,14,15,41]],[44,1,"p","LIB_US_GMC_Tent",objNull,"Zumi",[1944,7,14,15,41]],[45,1,"p","LIB_US_GMC_Tent",objNull,"Zumi",[1944,7,14,15,41]],[46,1,"p","LIB_US_GMC_Tent",objNull,"Zumi",[1944,7,14,15,41]],[47,1,"p","LIB_US_GMC_Tent",objNull,"Zumi",[1944,7,14,15,41]],[48,1,"p","LIB_US_Scout_M3",objNull,"Zumi",[1944,7,14,15,41]],[49,1,"p","LIB_US_Scout_M3",objNull,"Zumi",[1944,7,14,15,41]],[50,1,"p","LIB_US_Scout_M3",objNull,"Zumi",[1944,7,14,15,41]],[51,1,"p","LIB_US_Scout_M3",objNull,"Zumi",[1944,7,14,15,41]],[52,1,"p","LIB_US_Scout_M3",objNull,"Zumi",[1944,7,14,15,42]],[53,1,"p","LIB_US_Scout_M3",objNull,"Zumi",[1944,7,14,15,42]],[54,1,"p","LIB_US_Scout_M3",objNull,"Zumi",[1944,7,14,15,42]],[55,1,"p","LIB_US_Scout_M3",objNull,"Zumi",[1944,7,14,15,42]],[56,1,"p","LIB_US_M3_Halftrack",objNull,"Zumi",[1944,7,14,16,28]],[57,1,"p","LIB_US_M3_Halftrack",objNull,"Zumi",[1944,7,14,15,42]],[58,1,"p","LIB_US_M3_Halftrack",objNull,"Zumi",[1944,7,14,15,42]],[59,1,"p","LIB_US_M3_Halftrack",objNull,"Zumi",[1944,7,14,15,42]],[60,1,"p","LIB_US_M3_Halftrack",objNull,"Zumi",[1944,7,14,15,42]],[61,1,"p","LIB_US_M3_Halftrack",objNull,"Zumi",[1944,7,14,15,42]],[62,1,"p","LIB_US_M3_Halftrack",objNull,"Zumi",[1944,7,14,15,42]],[63,1,"p","LIB_US_M3_Halftrack",objNull,"Zumi",[1944,7,14,15,42]],[64,1,"p","LIB_M8_Greyhound",objNull,"Zumi",[1944,7,14,15,42]],[65,1,"p","LIB_M8_Greyhound",objNull,"Zumi",[1944,7,14,15,42]],[66,1,"p","LIB_M3A3_Stuart",objNull,"Zumi",[1944,7,14,15,42]],[67,1,"p","LIB_M3A3_Stuart",objNull,"Zumi",[1944,7,14,15,42]],[68,1,"p","LIB_M3A3_Stuart",objNull,"Zumi",[1944,7,14,15,42]],[69,1,"p","LIB_M3A3_Stuart",objNull,"Zumi",[1944,7,14,15,42]],[70,1,"p","LIB_M4A3_75",objNull,"Zumi",[1944,7,14,15,42]],[71,1,"p","LIB_M4A3_75",objNull,"Zumi",[1944,7,14,15,42]],[72,1,"p","LIB_M4A3_75",objNull,"Zumi",[1944,7,14,15,42]],[73,1,"p","LIB_M4A3_75",objNull,"Zumi",[1944,7,14,15,42]],[74,1,"p","LIB_M4A3_76",objNull,"Zumi",[1944,7,14,15,42]],[75,1,"p","LIB_M4A3_76",objNull,"Zumi",[1944,7,14,15,42]],[76,1,"p","LIB_M4A3_76",objNull,"Zumi",[1944,7,14,15,42]],[77,1,"p","LIB_M4A3_76",objNull,"Zumi",[1944,7,14,15,42]],[78,1,"p","LIB_M4A3_76_HVSS",objNull,"Zumi",[1944,7,14,15,42]],[79,1,"p","LIB_M4A3_76_HVSS",objNull,"Zumi",[1944,7,14,15,42]],[80,1,"p","LIB_M4A3_76_HVSS",objNull,"Zumi",[1944,7,14,15,42]],[81,1,"p","LIB_M4A3_76_HVSS",objNull,"Zumi",[1944,7,14,15,42]],[82,1,"p","LIB_US_P39_2",objNull,"Zumi",[1944,7,14,15,42]],[83,1,"p","LIB_US_P39_2",objNull,"Zumi",[1944,7,14,15,42]],[84,1,"p","LIB_US_P39_2",objNull,"Zumi",[1944,7,14,15,42]],[85,1,"p","LIB_US_P39_2",objNull,"Zumi",[1944,7,14,15,42]],[86,1,"p","LIB_P47",objNull,"Zumi",[1944,7,14,15,42]],[87,1,"p","LIB_P47",objNull,"Zumi",[1944,7,14,15,42]],[88,1,"p","LIB_C47_Skytrain",objNull,"Zumi",[1944,7,14,15,42]],[89,1,"p","LIB_C47_Skytrain",objNull,"Zumi",[1944,7,14,15,42]],[90,1,"p","LIB_C47_Skytrain",objNull,"Zumi",[1944,7,14,18,1]]];

if ((count Fahrzeuge_Temp) > 0) then {
  private ["_hitpointsdmg","_dmg","_ammo","_fuel","_san","_rep","_cargo","_weps","_mags","_items","_refueler","_ammotruck","_id"];
  for "_i" from 0 to (count Fahrzeuge_Temp) - 1 do {
    (Fahrzeuge_Temp select _i) params ["_id","_aktiv","_status","_typ","_objekt", "_name", "_datum"];
    if ((!isNull ((Fahrzeuge_Temp select _i) select 4)) && !(_status IN ["p","v"]) && (alive ((Fahrzeuge_Temp select _i) select 4))) then {
      _hitpointsdmg = getAllHitPointsDamage _objekt;
      _dmg = [];
      for "_i" from 0 to (count (_hitpointsdmg select 0))-1 do {
        _dmg pushBack [(_hitpointsdmg select 0) select _i, (_hitpointsdmg select 1) select _i, (_hitpointsdmg select 2) select _i];
      };
      _ammo = [_objekt] call ace_rearm_fnc_getNeedRearmMagazines;
      _fuel = fuel _objekt;
      _san = _objekt getVariable ["ace_medical_medicClass",0];
      _rep = _objekt getVariable ["ace_isRepairVehicle",0];
      _cargo = [];
      _weps = getWeaponCargo _objekt;
      _cargo pushBack _weps;
      _mags = getMagazineCargo _objekt;
      _cargo pushBack _mags;
      _items = getItemCargo _objekt;
      _cargo pushBack _items;
      _containers = [];
      {
        _containeritems = [];
        _containeritems pushBack (typeOf _x);
        _containeritems pushback (weaponsItemsCargo _x);
        _containeritems pushBack (getMagazineCargo _x);
        _containeritems pushBack (itemCargo _x);
        _containers pushBack _containeritems;
      } forEach (everyBackpack _objekt);
      _cargo pushBack _containers;
      _refueler = [_objekt] call ace_refuel_fnc_getFuel;
      _ammotruck = [_objekt] call ace_rearm_fnc_getSupplyCount;
      _locked = locked _objekt;
      ["write", ["Fuhrpark", format ["fzg_%1", (_i + 1)],
        [_id, _aktiv, getPosATL _objekt, _typ, "obj", _dmg, _ammo, _fuel, _san, _rep, _cargo, _refueler, _ammotruck, ([_objekt] call ace_common_fnc_getPitchBankYaw), _locked]
      ]] call _inidbi;
      Fahrzeuge pushBack [_i + 1,1,getPosATL _objekt,_typ,"Admin",date];
      //(Fahrzeuge select _i) set [2, getPosATL _objekt];
      ["write", ["Fuhrpark", "Fahrzeuge", Fahrzeuge]] call _inidbi;



    } else {
      if !(((Fahrzeuge_Temp select _i) select 2) IN ["p","v"]) then {
        Fahrzeuge pushBack [_i + 1,1,"v",_typ,"Admin",date];
        //(Fahrzeuge select _i) set [2, "v"];
        ["write", ["Fuhrpark", "Fahrzeuge", Fahrzeuge]] call _inidbi;
      };
    };
  };
};

if (_win) then {
  "victory" call BIS_fnc_endMissionServer;
} else {
  "defeat" call BIS_fnc_endMissionServer;
};
